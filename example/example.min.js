(function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require=="function"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error("Cannot find module '"+o+"'");throw f.code="MODULE_NOT_FOUND",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}var i=typeof require=="function"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s})({1:[function(require,module,exports){
(function (factory) {
    if (typeof module === 'object' && typeof module.exports === 'object') {
        var v = factory(require, exports); if (v !== undefined) module.exports = v;
    }
    else if (typeof define === 'function' && define.amd) {
        define(["require", "exports", '../swoosh'], factory);
    }
})(function (require, exports) {
    "use strict";
    var swoosh_1 = require('../swoosh');
    var div1 = document.getElementById("div1");
    var div2 = document.getElementById("div2");
    var div3 = document.getElementById("div3");
    var body = document.body;
    var s4 = swoosh_1.default(body, {
        elasticEgdes: {
            left: 0,
            right: 0,
            top: 50,
            bottom: 50,
        }
    });
    var s1 = swoosh_1.default(div1, {
        grid: 50,
        callback: function (e) {
            console.log('inside the options callback, obj-instance: ', this, 'event: ', e);
            return true;
        } })
        .on('collideLeft', function (e) {
        console.log('inside 2nd callback (collideLeft event): instance: ', this, 'event: ', e);
        return true;
    })
        .on('collideTop', function (e) {
        console.log('inside 2nd callback (collideTop event): instance: ', this, 'event: ', e);
        return true;
    })
        .on('collideRight', function (e) {
        console.log('inside 2nd callback (collideRight event): instance: ', this, 'event: ', e);
        return true;
    })
        .on('collideBottom', function (e) {
        console.log('inside 2nd callback (collideBottom event): instance: ', this, 'event: ', e);
        return true;
    });
    var s2 = swoosh_1.default(div2, {
        elasticEgdes: {
            left: 100,
            right: 100,
            top: 200,
            bottom: 200,
        }
    });
    var s3 = swoosh_1.default(div3, {});
});

},{"../swoosh":2}],2:[function(require,module,exports){
/*
names:
infinite
inifinity room / space / mirror
1-sphere
tardis
tesseract
4th dimension
Dimensionally transindental

pic:
https://en.wikipedia.org/wiki/Infinity_mirror

*/
(function (factory) {
    if (typeof module === 'object' && typeof module.exports === 'object') {
        var v = factory(require, exports); if (v !== undefined) module.exports = v;
    }
    else if (typeof define === 'function' && define.amd) {
        define(["require", "exports"], factory);
    }
})(function (require, exports) {
    "use strict";
    function default_1(container, options) {
        var Swoosh = (function () {
            function Swoosh(container, options) {
                var _this = this;
                this.container = container;
                this.options = options;
                this.container = container;
                /* set default options */
                this.options = {
                    grid: 1,
                    elasticEgdes: {
                        left: 50,
                        right: 50,
                        top: 50,
                        bottom: 50,
                    },
                    callback: this.always
                };
                Object.assign(this.options, options); //merge options object
                console.log(this.options);
                this.container.className += " outer";
                /* create inner div element and append it to the container with its contents in it */
                this.inner = document.createElement("div");
                this.inner.className += " inner";
                /* move all childNodes to the new inner element */
                while (this.container.childNodes.length > 0) {
                    this.inner.appendChild(this.container.childNodes[0]);
                }
                this.container.appendChild(this.inner);
                this.inner.style.minWidth = this.container.scrollWidth + 'px';
                this.inner.style.minHeight = this.container.scrollHeight + 'px';
                this.inner.style.paddingLeft = this.options.elasticEgdes.left + 'px';
                this.inner.style.paddingRight = this.options.elasticEgdes.right + 'px';
                this.inner.style.paddingTop = this.options.elasticEgdes.top + 'px';
                this.inner.style.paddingBottom = this.options.elasticEgdes.bottom + 'px';
                this.scrollElement = this.inner.parentElement.tagName == "BODY" ? document.documentElement : this.inner.parentElement;
                console.log(this.options.elasticEgdes.left);
                this.scrollTo(this.options.elasticEgdes.left, this.options.elasticEgdes.top);
                /*this.container.addEventListener('wheel', function(e){
                  console.log('scroll: ', e);
                  if (e.preventDefault)
                      e.preventDefault();
                  e.returnValue = false;
                });*/
                this.mouseDownHandler = function (e) { return _this.mouseDown(e); };
                this.inner.addEventListener('mousedown', this.mouseDownHandler);
            }
            Swoosh.prototype.mouseDown = function (e) {
                var _this = this;
                var elementBehindCursor = document.elementFromPoint(e.clientX, e.clientY);
                /* find the next parent which is an inner element */
                while (elementBehindCursor && !elementBehindCursor.classList.contains('inner')) {
                    elementBehindCursor = elementBehindCursor.parentElement;
                }
                if (this.inner == elementBehindCursor) {
                    this.inner.className += ' grabbing';
                    /* note the origin positions */
                    this.dragOriginLeft = e.clientX;
                    this.dragOriginTop = e.clientY;
                    this.dragOriginScrollLeft = this.scrollElement.scrollLeft;
                    this.dragOriginScrollTop = this.scrollElement.scrollTop;
                    /* it looks strane if scroll-behavior is set to smooth */
                    this.parentOriginStyle = this.inner.parentElement.style.cssText;
                    this.inner.parentElement.style.setProperty('scroll-behavior', 'auto');
                    this.mouseMoveHandler = this.mouseMove.bind(this);
                    document.addEventListener('mousemove', this.mouseMoveHandler);
                    this.mouseUpHandler = function (e) { return _this.mouseUp(e); };
                    document.addEventListener('mouseup', this.mouseUpHandler);
                }
            };
            Swoosh.prototype.mouseUp = function (e) {
                //stick the element to the grid
                var x = Math.round((this.dragOriginLeft + this.dragOriginScrollLeft - e.clientX) / this.options.grid) * this.options.grid;
                var y = Math.round((this.dragOriginTop + this.dragOriginScrollTop - e.clientY) / this.options.grid) * this.options.grid;
                var scrollMaxLeft = (this.scrollElement.scrollWidth - this.scrollElement.clientWidth) - this.options.elasticEgdes.left;
                var scrollMaxTop = (this.scrollElement.scrollHeight - this.scrollElement.clientHeight) - this.options.elasticEgdes.top;
                x = (x > scrollMaxLeft) ? scrollMaxLeft : (x < this.options.elasticEgdes.left) ? this.options.elasticEgdes.left : x;
                y = (y > scrollMaxTop) ? scrollMaxTop : (y < this.options.elasticEgdes.top) ? this.options.elasticEgdes.top : y;
                this.inner.className = this.inner.className.replace(/\b grabbing\b/, '');
                this.inner.parentElement.style.cssText = this.parentOriginStyle;
                this.scrollTo(x, y);
                document.removeEventListener('mousemove', this.mouseMoveHandler);
                document.removeEventListener('mouseup', this.mouseUpHandler);
            };
            Swoosh.prototype.mouseMove = function (e) {
                e.preventDefault();
                var x = this.dragOriginLeft + this.dragOriginScrollLeft - e.clientX;
                var y = this.dragOriginTop + this.dragOriginScrollTop - e.clientY;
                this.scrollTo(x, y);
            };
            /* scroll helper method */
            Swoosh.prototype.scrollTo = function (x, y) {
                var scrollMaxLeft = (this.scrollElement.scrollWidth - this.scrollElement.clientWidth);
                var scrollMaxTop = (this.scrollElement.scrollHeight - this.scrollElement.clientHeight);
                /* no negative values or greater than the maximum */
                var x = (x > scrollMaxLeft) ? scrollMaxLeft : (x < 0) ? 0 : x;
                var y = (y > scrollMaxTop) ? scrollMaxTop : (y < 0) ? 0 : y;
                /* remember the old values */
                this.originScrollLeft = this.scrollElement.scrollLeft;
                this.originScrollTop = this.scrollElement.scrollTop;
                this.scrollElement.scrollTo(x, y);
                /* the collideLeft event */
                if (x == 0 && this.originScrollLeft != x) {
                    var event = document.createEvent("HTMLEvents");
                    event.initEvent("collideLeft", true, true);
                    this.inner.dispatchEvent(event);
                }
                /* the collideTop event */
                if (y == 0 && this.originScrollTop != y) {
                    var event = document.createEvent("HTMLEvents");
                    event.initEvent("collideTop", true, true);
                    this.inner.dispatchEvent(event);
                }
                /* the collideRight event */
                if (x == scrollMaxLeft && this.originScrollLeft != x) {
                    var event = document.createEvent("HTMLEvents");
                    event.initEvent("collideRight", true, true);
                    this.inner.dispatchEvent(event);
                }
                /* the collideBottom event */
                if (y == scrollMaxTop && this.originScrollTop != y) {
                    var event = document.createEvent("HTMLEvents");
                    event.initEvent("collideBottom", true, true);
                    this.inner.dispatchEvent(event);
                }
            };
            /* method to register custom event callbacks */
            Swoosh.prototype.on = function (event, callback) {
                console.log('on() event callback register', event);
                this.inner.addEventListener(event, callback.bind(this));
                return this;
            };
            Swoosh.prototype.always = function () { console.log('always()'); return true; };
            return Swoosh;
        }());
        /* return an instance of the object */
        return new Swoosh(container, options);
    }
    Object.defineProperty(exports, "__esModule", { value: true });
    exports.default = default_1;
});

},{}]},{},[1])
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIm5vZGVfbW9kdWxlcy9icm93c2VyLXBhY2svX3ByZWx1ZGUuanMiLCJleGFtcGxlL2V4YW1wbGUuanMiLCJzd29vc2guanMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUE7QUNBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUN0REE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBIiwiZmlsZSI6ImdlbmVyYXRlZC5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzQ29udGVudCI6WyIoZnVuY3Rpb24gZSh0LG4scil7ZnVuY3Rpb24gcyhvLHUpe2lmKCFuW29dKXtpZighdFtvXSl7dmFyIGE9dHlwZW9mIHJlcXVpcmU9PVwiZnVuY3Rpb25cIiYmcmVxdWlyZTtpZighdSYmYSlyZXR1cm4gYShvLCEwKTtpZihpKXJldHVybiBpKG8sITApO3ZhciBmPW5ldyBFcnJvcihcIkNhbm5vdCBmaW5kIG1vZHVsZSAnXCIrbytcIidcIik7dGhyb3cgZi5jb2RlPVwiTU9EVUxFX05PVF9GT1VORFwiLGZ9dmFyIGw9bltvXT17ZXhwb3J0czp7fX07dFtvXVswXS5jYWxsKGwuZXhwb3J0cyxmdW5jdGlvbihlKXt2YXIgbj10W29dWzFdW2VdO3JldHVybiBzKG4/bjplKX0sbCxsLmV4cG9ydHMsZSx0LG4scil9cmV0dXJuIG5bb10uZXhwb3J0c312YXIgaT10eXBlb2YgcmVxdWlyZT09XCJmdW5jdGlvblwiJiZyZXF1aXJlO2Zvcih2YXIgbz0wO288ci5sZW5ndGg7bysrKXMocltvXSk7cmV0dXJuIHN9KSIsIihmdW5jdGlvbiAoZmFjdG9yeSkge1xuICAgIGlmICh0eXBlb2YgbW9kdWxlID09PSAnb2JqZWN0JyAmJiB0eXBlb2YgbW9kdWxlLmV4cG9ydHMgPT09ICdvYmplY3QnKSB7XG4gICAgICAgIHZhciB2ID0gZmFjdG9yeShyZXF1aXJlLCBleHBvcnRzKTsgaWYgKHYgIT09IHVuZGVmaW5lZCkgbW9kdWxlLmV4cG9ydHMgPSB2O1xuICAgIH1cbiAgICBlbHNlIGlmICh0eXBlb2YgZGVmaW5lID09PSAnZnVuY3Rpb24nICYmIGRlZmluZS5hbWQpIHtcbiAgICAgICAgZGVmaW5lKFtcInJlcXVpcmVcIiwgXCJleHBvcnRzXCIsICcuLi9zd29vc2gnXSwgZmFjdG9yeSk7XG4gICAgfVxufSkoZnVuY3Rpb24gKHJlcXVpcmUsIGV4cG9ydHMpIHtcbiAgICBcInVzZSBzdHJpY3RcIjtcbiAgICB2YXIgc3dvb3NoXzEgPSByZXF1aXJlKCcuLi9zd29vc2gnKTtcbiAgICB2YXIgZGl2MSA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwiZGl2MVwiKTtcbiAgICB2YXIgZGl2MiA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwiZGl2MlwiKTtcbiAgICB2YXIgZGl2MyA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwiZGl2M1wiKTtcbiAgICB2YXIgYm9keSA9IGRvY3VtZW50LmJvZHk7XG4gICAgdmFyIHM0ID0gc3dvb3NoXzEuZGVmYXVsdChib2R5LCB7XG4gICAgICAgIGVsYXN0aWNFZ2Rlczoge1xuICAgICAgICAgICAgbGVmdDogMCxcbiAgICAgICAgICAgIHJpZ2h0OiAwLFxuICAgICAgICAgICAgdG9wOiA1MCxcbiAgICAgICAgICAgIGJvdHRvbTogNTAsXG4gICAgICAgIH1cbiAgICB9KTtcbiAgICB2YXIgczEgPSBzd29vc2hfMS5kZWZhdWx0KGRpdjEsIHtcbiAgICAgICAgZ3JpZDogNTAsXG4gICAgICAgIGNhbGxiYWNrOiBmdW5jdGlvbiAoZSkge1xuICAgICAgICAgICAgY29uc29sZS5sb2coJ2luc2lkZSB0aGUgb3B0aW9ucyBjYWxsYmFjaywgb2JqLWluc3RhbmNlOiAnLCB0aGlzLCAnZXZlbnQ6ICcsIGUpO1xuICAgICAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICAgIH0gfSlcbiAgICAgICAgLm9uKCdjb2xsaWRlTGVmdCcsIGZ1bmN0aW9uIChlKSB7XG4gICAgICAgIGNvbnNvbGUubG9nKCdpbnNpZGUgMm5kIGNhbGxiYWNrIChjb2xsaWRlTGVmdCBldmVudCk6IGluc3RhbmNlOiAnLCB0aGlzLCAnZXZlbnQ6ICcsIGUpO1xuICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICB9KVxuICAgICAgICAub24oJ2NvbGxpZGVUb3AnLCBmdW5jdGlvbiAoZSkge1xuICAgICAgICBjb25zb2xlLmxvZygnaW5zaWRlIDJuZCBjYWxsYmFjayAoY29sbGlkZVRvcCBldmVudCk6IGluc3RhbmNlOiAnLCB0aGlzLCAnZXZlbnQ6ICcsIGUpO1xuICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICB9KVxuICAgICAgICAub24oJ2NvbGxpZGVSaWdodCcsIGZ1bmN0aW9uIChlKSB7XG4gICAgICAgIGNvbnNvbGUubG9nKCdpbnNpZGUgMm5kIGNhbGxiYWNrIChjb2xsaWRlUmlnaHQgZXZlbnQpOiBpbnN0YW5jZTogJywgdGhpcywgJ2V2ZW50OiAnLCBlKTtcbiAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgfSlcbiAgICAgICAgLm9uKCdjb2xsaWRlQm90dG9tJywgZnVuY3Rpb24gKGUpIHtcbiAgICAgICAgY29uc29sZS5sb2coJ2luc2lkZSAybmQgY2FsbGJhY2sgKGNvbGxpZGVCb3R0b20gZXZlbnQpOiBpbnN0YW5jZTogJywgdGhpcywgJ2V2ZW50OiAnLCBlKTtcbiAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgfSk7XG4gICAgdmFyIHMyID0gc3dvb3NoXzEuZGVmYXVsdChkaXYyLCB7XG4gICAgICAgIGVsYXN0aWNFZ2Rlczoge1xuICAgICAgICAgICAgbGVmdDogMTAwLFxuICAgICAgICAgICAgcmlnaHQ6IDEwMCxcbiAgICAgICAgICAgIHRvcDogMjAwLFxuICAgICAgICAgICAgYm90dG9tOiAyMDAsXG4gICAgICAgIH1cbiAgICB9KTtcbiAgICB2YXIgczMgPSBzd29vc2hfMS5kZWZhdWx0KGRpdjMsIHt9KTtcbn0pO1xuLy8jIHNvdXJjZU1hcHBpbmdVUkw9ZXhhbXBsZS5qcy5tYXAiLCIvKlxubmFtZXM6XG5pbmZpbml0ZVxuaW5pZmluaXR5IHJvb20gLyBzcGFjZSAvIG1pcnJvclxuMS1zcGhlcmVcbnRhcmRpc1xudGVzc2VyYWN0XG40dGggZGltZW5zaW9uXG5EaW1lbnNpb25hbGx5IHRyYW5zaW5kZW50YWxcblxucGljOlxuaHR0cHM6Ly9lbi53aWtpcGVkaWEub3JnL3dpa2kvSW5maW5pdHlfbWlycm9yXG5cbiovXG4oZnVuY3Rpb24gKGZhY3RvcnkpIHtcbiAgICBpZiAodHlwZW9mIG1vZHVsZSA9PT0gJ29iamVjdCcgJiYgdHlwZW9mIG1vZHVsZS5leHBvcnRzID09PSAnb2JqZWN0Jykge1xuICAgICAgICB2YXIgdiA9IGZhY3RvcnkocmVxdWlyZSwgZXhwb3J0cyk7IGlmICh2ICE9PSB1bmRlZmluZWQpIG1vZHVsZS5leHBvcnRzID0gdjtcbiAgICB9XG4gICAgZWxzZSBpZiAodHlwZW9mIGRlZmluZSA9PT0gJ2Z1bmN0aW9uJyAmJiBkZWZpbmUuYW1kKSB7XG4gICAgICAgIGRlZmluZShbXCJyZXF1aXJlXCIsIFwiZXhwb3J0c1wiXSwgZmFjdG9yeSk7XG4gICAgfVxufSkoZnVuY3Rpb24gKHJlcXVpcmUsIGV4cG9ydHMpIHtcbiAgICBcInVzZSBzdHJpY3RcIjtcbiAgICBmdW5jdGlvbiBkZWZhdWx0XzEoY29udGFpbmVyLCBvcHRpb25zKSB7XG4gICAgICAgIHZhciBTd29vc2ggPSAoZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgZnVuY3Rpb24gU3dvb3NoKGNvbnRhaW5lciwgb3B0aW9ucykge1xuICAgICAgICAgICAgICAgIHZhciBfdGhpcyA9IHRoaXM7XG4gICAgICAgICAgICAgICAgdGhpcy5jb250YWluZXIgPSBjb250YWluZXI7XG4gICAgICAgICAgICAgICAgdGhpcy5vcHRpb25zID0gb3B0aW9ucztcbiAgICAgICAgICAgICAgICB0aGlzLmNvbnRhaW5lciA9IGNvbnRhaW5lcjtcbiAgICAgICAgICAgICAgICAvKiBzZXQgZGVmYXVsdCBvcHRpb25zICovXG4gICAgICAgICAgICAgICAgdGhpcy5vcHRpb25zID0ge1xuICAgICAgICAgICAgICAgICAgICBncmlkOiAxLFxuICAgICAgICAgICAgICAgICAgICBlbGFzdGljRWdkZXM6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGxlZnQ6IDUwLFxuICAgICAgICAgICAgICAgICAgICAgICAgcmlnaHQ6IDUwLFxuICAgICAgICAgICAgICAgICAgICAgICAgdG9wOiA1MCxcbiAgICAgICAgICAgICAgICAgICAgICAgIGJvdHRvbTogNTAsXG4gICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgIGNhbGxiYWNrOiB0aGlzLmFsd2F5c1xuICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICAgICAgT2JqZWN0LmFzc2lnbih0aGlzLm9wdGlvbnMsIG9wdGlvbnMpOyAvL21lcmdlIG9wdGlvbnMgb2JqZWN0XG4gICAgICAgICAgICAgICAgY29uc29sZS5sb2codGhpcy5vcHRpb25zKTtcbiAgICAgICAgICAgICAgICB0aGlzLmNvbnRhaW5lci5jbGFzc05hbWUgKz0gXCIgb3V0ZXJcIjtcbiAgICAgICAgICAgICAgICAvKiBjcmVhdGUgaW5uZXIgZGl2IGVsZW1lbnQgYW5kIGFwcGVuZCBpdCB0byB0aGUgY29udGFpbmVyIHdpdGggaXRzIGNvbnRlbnRzIGluIGl0ICovXG4gICAgICAgICAgICAgICAgdGhpcy5pbm5lciA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJkaXZcIik7XG4gICAgICAgICAgICAgICAgdGhpcy5pbm5lci5jbGFzc05hbWUgKz0gXCIgaW5uZXJcIjtcbiAgICAgICAgICAgICAgICAvKiBtb3ZlIGFsbCBjaGlsZE5vZGVzIHRvIHRoZSBuZXcgaW5uZXIgZWxlbWVudCAqL1xuICAgICAgICAgICAgICAgIHdoaWxlICh0aGlzLmNvbnRhaW5lci5jaGlsZE5vZGVzLmxlbmd0aCA+IDApIHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5pbm5lci5hcHBlbmRDaGlsZCh0aGlzLmNvbnRhaW5lci5jaGlsZE5vZGVzWzBdKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgdGhpcy5jb250YWluZXIuYXBwZW5kQ2hpbGQodGhpcy5pbm5lcik7XG4gICAgICAgICAgICAgICAgdGhpcy5pbm5lci5zdHlsZS5taW5XaWR0aCA9IHRoaXMuY29udGFpbmVyLnNjcm9sbFdpZHRoICsgJ3B4JztcbiAgICAgICAgICAgICAgICB0aGlzLmlubmVyLnN0eWxlLm1pbkhlaWdodCA9IHRoaXMuY29udGFpbmVyLnNjcm9sbEhlaWdodCArICdweCc7XG4gICAgICAgICAgICAgICAgdGhpcy5pbm5lci5zdHlsZS5wYWRkaW5nTGVmdCA9IHRoaXMub3B0aW9ucy5lbGFzdGljRWdkZXMubGVmdCArICdweCc7XG4gICAgICAgICAgICAgICAgdGhpcy5pbm5lci5zdHlsZS5wYWRkaW5nUmlnaHQgPSB0aGlzLm9wdGlvbnMuZWxhc3RpY0VnZGVzLnJpZ2h0ICsgJ3B4JztcbiAgICAgICAgICAgICAgICB0aGlzLmlubmVyLnN0eWxlLnBhZGRpbmdUb3AgPSB0aGlzLm9wdGlvbnMuZWxhc3RpY0VnZGVzLnRvcCArICdweCc7XG4gICAgICAgICAgICAgICAgdGhpcy5pbm5lci5zdHlsZS5wYWRkaW5nQm90dG9tID0gdGhpcy5vcHRpb25zLmVsYXN0aWNFZ2Rlcy5ib3R0b20gKyAncHgnO1xuICAgICAgICAgICAgICAgIHRoaXMuc2Nyb2xsRWxlbWVudCA9IHRoaXMuaW5uZXIucGFyZW50RWxlbWVudC50YWdOYW1lID09IFwiQk9EWVwiID8gZG9jdW1lbnQuZG9jdW1lbnRFbGVtZW50IDogdGhpcy5pbm5lci5wYXJlbnRFbGVtZW50O1xuICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKHRoaXMub3B0aW9ucy5lbGFzdGljRWdkZXMubGVmdCk7XG4gICAgICAgICAgICAgICAgdGhpcy5zY3JvbGxUbyh0aGlzLm9wdGlvbnMuZWxhc3RpY0VnZGVzLmxlZnQsIHRoaXMub3B0aW9ucy5lbGFzdGljRWdkZXMudG9wKTtcbiAgICAgICAgICAgICAgICAvKnRoaXMuY29udGFpbmVyLmFkZEV2ZW50TGlzdGVuZXIoJ3doZWVsJywgZnVuY3Rpb24oZSl7XG4gICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZygnc2Nyb2xsOiAnLCBlKTtcbiAgICAgICAgICAgICAgICAgIGlmIChlLnByZXZlbnREZWZhdWx0KVxuICAgICAgICAgICAgICAgICAgICAgIGUucHJldmVudERlZmF1bHQoKTtcbiAgICAgICAgICAgICAgICAgIGUucmV0dXJuVmFsdWUgPSBmYWxzZTtcbiAgICAgICAgICAgICAgICB9KTsqL1xuICAgICAgICAgICAgICAgIHRoaXMubW91c2VEb3duSGFuZGxlciA9IGZ1bmN0aW9uIChlKSB7IHJldHVybiBfdGhpcy5tb3VzZURvd24oZSk7IH07XG4gICAgICAgICAgICAgICAgdGhpcy5pbm5lci5hZGRFdmVudExpc3RlbmVyKCdtb3VzZWRvd24nLCB0aGlzLm1vdXNlRG93bkhhbmRsZXIpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgU3dvb3NoLnByb3RvdHlwZS5tb3VzZURvd24gPSBmdW5jdGlvbiAoZSkge1xuICAgICAgICAgICAgICAgIHZhciBfdGhpcyA9IHRoaXM7XG4gICAgICAgICAgICAgICAgdmFyIGVsZW1lbnRCZWhpbmRDdXJzb3IgPSBkb2N1bWVudC5lbGVtZW50RnJvbVBvaW50KGUuY2xpZW50WCwgZS5jbGllbnRZKTtcbiAgICAgICAgICAgICAgICAvKiBmaW5kIHRoZSBuZXh0IHBhcmVudCB3aGljaCBpcyBhbiBpbm5lciBlbGVtZW50ICovXG4gICAgICAgICAgICAgICAgd2hpbGUgKGVsZW1lbnRCZWhpbmRDdXJzb3IgJiYgIWVsZW1lbnRCZWhpbmRDdXJzb3IuY2xhc3NMaXN0LmNvbnRhaW5zKCdpbm5lcicpKSB7XG4gICAgICAgICAgICAgICAgICAgIGVsZW1lbnRCZWhpbmRDdXJzb3IgPSBlbGVtZW50QmVoaW5kQ3Vyc29yLnBhcmVudEVsZW1lbnQ7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGlmICh0aGlzLmlubmVyID09IGVsZW1lbnRCZWhpbmRDdXJzb3IpIHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5pbm5lci5jbGFzc05hbWUgKz0gJyBncmFiYmluZyc7XG4gICAgICAgICAgICAgICAgICAgIC8qIG5vdGUgdGhlIG9yaWdpbiBwb3NpdGlvbnMgKi9cbiAgICAgICAgICAgICAgICAgICAgdGhpcy5kcmFnT3JpZ2luTGVmdCA9IGUuY2xpZW50WDtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5kcmFnT3JpZ2luVG9wID0gZS5jbGllbnRZO1xuICAgICAgICAgICAgICAgICAgICB0aGlzLmRyYWdPcmlnaW5TY3JvbGxMZWZ0ID0gdGhpcy5zY3JvbGxFbGVtZW50LnNjcm9sbExlZnQ7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuZHJhZ09yaWdpblNjcm9sbFRvcCA9IHRoaXMuc2Nyb2xsRWxlbWVudC5zY3JvbGxUb3A7XG4gICAgICAgICAgICAgICAgICAgIC8qIGl0IGxvb2tzIHN0cmFuZSBpZiBzY3JvbGwtYmVoYXZpb3IgaXMgc2V0IHRvIHNtb290aCAqL1xuICAgICAgICAgICAgICAgICAgICB0aGlzLnBhcmVudE9yaWdpblN0eWxlID0gdGhpcy5pbm5lci5wYXJlbnRFbGVtZW50LnN0eWxlLmNzc1RleHQ7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuaW5uZXIucGFyZW50RWxlbWVudC5zdHlsZS5zZXRQcm9wZXJ0eSgnc2Nyb2xsLWJlaGF2aW9yJywgJ2F1dG8nKTtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5tb3VzZU1vdmVIYW5kbGVyID0gdGhpcy5tb3VzZU1vdmUuYmluZCh0aGlzKTtcbiAgICAgICAgICAgICAgICAgICAgZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcignbW91c2Vtb3ZlJywgdGhpcy5tb3VzZU1vdmVIYW5kbGVyKTtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5tb3VzZVVwSGFuZGxlciA9IGZ1bmN0aW9uIChlKSB7IHJldHVybiBfdGhpcy5tb3VzZVVwKGUpOyB9O1xuICAgICAgICAgICAgICAgICAgICBkb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKCdtb3VzZXVwJywgdGhpcy5tb3VzZVVwSGFuZGxlcik7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIFN3b29zaC5wcm90b3R5cGUubW91c2VVcCA9IGZ1bmN0aW9uIChlKSB7XG4gICAgICAgICAgICAgICAgLy9zdGljayB0aGUgZWxlbWVudCB0byB0aGUgZ3JpZFxuICAgICAgICAgICAgICAgIHZhciB4ID0gTWF0aC5yb3VuZCgodGhpcy5kcmFnT3JpZ2luTGVmdCArIHRoaXMuZHJhZ09yaWdpblNjcm9sbExlZnQgLSBlLmNsaWVudFgpIC8gdGhpcy5vcHRpb25zLmdyaWQpICogdGhpcy5vcHRpb25zLmdyaWQ7XG4gICAgICAgICAgICAgICAgdmFyIHkgPSBNYXRoLnJvdW5kKCh0aGlzLmRyYWdPcmlnaW5Ub3AgKyB0aGlzLmRyYWdPcmlnaW5TY3JvbGxUb3AgLSBlLmNsaWVudFkpIC8gdGhpcy5vcHRpb25zLmdyaWQpICogdGhpcy5vcHRpb25zLmdyaWQ7XG4gICAgICAgICAgICAgICAgdmFyIHNjcm9sbE1heExlZnQgPSAodGhpcy5zY3JvbGxFbGVtZW50LnNjcm9sbFdpZHRoIC0gdGhpcy5zY3JvbGxFbGVtZW50LmNsaWVudFdpZHRoKSAtIHRoaXMub3B0aW9ucy5lbGFzdGljRWdkZXMubGVmdDtcbiAgICAgICAgICAgICAgICB2YXIgc2Nyb2xsTWF4VG9wID0gKHRoaXMuc2Nyb2xsRWxlbWVudC5zY3JvbGxIZWlnaHQgLSB0aGlzLnNjcm9sbEVsZW1lbnQuY2xpZW50SGVpZ2h0KSAtIHRoaXMub3B0aW9ucy5lbGFzdGljRWdkZXMudG9wO1xuICAgICAgICAgICAgICAgIHggPSAoeCA+IHNjcm9sbE1heExlZnQpID8gc2Nyb2xsTWF4TGVmdCA6ICh4IDwgdGhpcy5vcHRpb25zLmVsYXN0aWNFZ2Rlcy5sZWZ0KSA/IHRoaXMub3B0aW9ucy5lbGFzdGljRWdkZXMubGVmdCA6IHg7XG4gICAgICAgICAgICAgICAgeSA9ICh5ID4gc2Nyb2xsTWF4VG9wKSA/IHNjcm9sbE1heFRvcCA6ICh5IDwgdGhpcy5vcHRpb25zLmVsYXN0aWNFZ2Rlcy50b3ApID8gdGhpcy5vcHRpb25zLmVsYXN0aWNFZ2Rlcy50b3AgOiB5O1xuICAgICAgICAgICAgICAgIHRoaXMuaW5uZXIuY2xhc3NOYW1lID0gdGhpcy5pbm5lci5jbGFzc05hbWUucmVwbGFjZSgvXFxiIGdyYWJiaW5nXFxiLywgJycpO1xuICAgICAgICAgICAgICAgIHRoaXMuaW5uZXIucGFyZW50RWxlbWVudC5zdHlsZS5jc3NUZXh0ID0gdGhpcy5wYXJlbnRPcmlnaW5TdHlsZTtcbiAgICAgICAgICAgICAgICB0aGlzLnNjcm9sbFRvKHgsIHkpO1xuICAgICAgICAgICAgICAgIGRvY3VtZW50LnJlbW92ZUV2ZW50TGlzdGVuZXIoJ21vdXNlbW92ZScsIHRoaXMubW91c2VNb3ZlSGFuZGxlcik7XG4gICAgICAgICAgICAgICAgZG9jdW1lbnQucmVtb3ZlRXZlbnRMaXN0ZW5lcignbW91c2V1cCcsIHRoaXMubW91c2VVcEhhbmRsZXIpO1xuICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIFN3b29zaC5wcm90b3R5cGUubW91c2VNb3ZlID0gZnVuY3Rpb24gKGUpIHtcbiAgICAgICAgICAgICAgICBlLnByZXZlbnREZWZhdWx0KCk7XG4gICAgICAgICAgICAgICAgdmFyIHggPSB0aGlzLmRyYWdPcmlnaW5MZWZ0ICsgdGhpcy5kcmFnT3JpZ2luU2Nyb2xsTGVmdCAtIGUuY2xpZW50WDtcbiAgICAgICAgICAgICAgICB2YXIgeSA9IHRoaXMuZHJhZ09yaWdpblRvcCArIHRoaXMuZHJhZ09yaWdpblNjcm9sbFRvcCAtIGUuY2xpZW50WTtcbiAgICAgICAgICAgICAgICB0aGlzLnNjcm9sbFRvKHgsIHkpO1xuICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIC8qIHNjcm9sbCBoZWxwZXIgbWV0aG9kICovXG4gICAgICAgICAgICBTd29vc2gucHJvdG90eXBlLnNjcm9sbFRvID0gZnVuY3Rpb24gKHgsIHkpIHtcbiAgICAgICAgICAgICAgICB2YXIgc2Nyb2xsTWF4TGVmdCA9ICh0aGlzLnNjcm9sbEVsZW1lbnQuc2Nyb2xsV2lkdGggLSB0aGlzLnNjcm9sbEVsZW1lbnQuY2xpZW50V2lkdGgpO1xuICAgICAgICAgICAgICAgIHZhciBzY3JvbGxNYXhUb3AgPSAodGhpcy5zY3JvbGxFbGVtZW50LnNjcm9sbEhlaWdodCAtIHRoaXMuc2Nyb2xsRWxlbWVudC5jbGllbnRIZWlnaHQpO1xuICAgICAgICAgICAgICAgIC8qIG5vIG5lZ2F0aXZlIHZhbHVlcyBvciBncmVhdGVyIHRoYW4gdGhlIG1heGltdW0gKi9cbiAgICAgICAgICAgICAgICB2YXIgeCA9ICh4ID4gc2Nyb2xsTWF4TGVmdCkgPyBzY3JvbGxNYXhMZWZ0IDogKHggPCAwKSA/IDAgOiB4O1xuICAgICAgICAgICAgICAgIHZhciB5ID0gKHkgPiBzY3JvbGxNYXhUb3ApID8gc2Nyb2xsTWF4VG9wIDogKHkgPCAwKSA/IDAgOiB5O1xuICAgICAgICAgICAgICAgIC8qIHJlbWVtYmVyIHRoZSBvbGQgdmFsdWVzICovXG4gICAgICAgICAgICAgICAgdGhpcy5vcmlnaW5TY3JvbGxMZWZ0ID0gdGhpcy5zY3JvbGxFbGVtZW50LnNjcm9sbExlZnQ7XG4gICAgICAgICAgICAgICAgdGhpcy5vcmlnaW5TY3JvbGxUb3AgPSB0aGlzLnNjcm9sbEVsZW1lbnQuc2Nyb2xsVG9wO1xuICAgICAgICAgICAgICAgIHRoaXMuc2Nyb2xsRWxlbWVudC5zY3JvbGxUbyh4LCB5KTtcbiAgICAgICAgICAgICAgICAvKiB0aGUgY29sbGlkZUxlZnQgZXZlbnQgKi9cbiAgICAgICAgICAgICAgICBpZiAoeCA9PSAwICYmIHRoaXMub3JpZ2luU2Nyb2xsTGVmdCAhPSB4KSB7XG4gICAgICAgICAgICAgICAgICAgIHZhciBldmVudCA9IGRvY3VtZW50LmNyZWF0ZUV2ZW50KFwiSFRNTEV2ZW50c1wiKTtcbiAgICAgICAgICAgICAgICAgICAgZXZlbnQuaW5pdEV2ZW50KFwiY29sbGlkZUxlZnRcIiwgdHJ1ZSwgdHJ1ZSk7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuaW5uZXIuZGlzcGF0Y2hFdmVudChldmVudCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIC8qIHRoZSBjb2xsaWRlVG9wIGV2ZW50ICovXG4gICAgICAgICAgICAgICAgaWYgKHkgPT0gMCAmJiB0aGlzLm9yaWdpblNjcm9sbFRvcCAhPSB5KSB7XG4gICAgICAgICAgICAgICAgICAgIHZhciBldmVudCA9IGRvY3VtZW50LmNyZWF0ZUV2ZW50KFwiSFRNTEV2ZW50c1wiKTtcbiAgICAgICAgICAgICAgICAgICAgZXZlbnQuaW5pdEV2ZW50KFwiY29sbGlkZVRvcFwiLCB0cnVlLCB0cnVlKTtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5pbm5lci5kaXNwYXRjaEV2ZW50KGV2ZW50KTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgLyogdGhlIGNvbGxpZGVSaWdodCBldmVudCAqL1xuICAgICAgICAgICAgICAgIGlmICh4ID09IHNjcm9sbE1heExlZnQgJiYgdGhpcy5vcmlnaW5TY3JvbGxMZWZ0ICE9IHgpIHtcbiAgICAgICAgICAgICAgICAgICAgdmFyIGV2ZW50ID0gZG9jdW1lbnQuY3JlYXRlRXZlbnQoXCJIVE1MRXZlbnRzXCIpO1xuICAgICAgICAgICAgICAgICAgICBldmVudC5pbml0RXZlbnQoXCJjb2xsaWRlUmlnaHRcIiwgdHJ1ZSwgdHJ1ZSk7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuaW5uZXIuZGlzcGF0Y2hFdmVudChldmVudCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIC8qIHRoZSBjb2xsaWRlQm90dG9tIGV2ZW50ICovXG4gICAgICAgICAgICAgICAgaWYgKHkgPT0gc2Nyb2xsTWF4VG9wICYmIHRoaXMub3JpZ2luU2Nyb2xsVG9wICE9IHkpIHtcbiAgICAgICAgICAgICAgICAgICAgdmFyIGV2ZW50ID0gZG9jdW1lbnQuY3JlYXRlRXZlbnQoXCJIVE1MRXZlbnRzXCIpO1xuICAgICAgICAgICAgICAgICAgICBldmVudC5pbml0RXZlbnQoXCJjb2xsaWRlQm90dG9tXCIsIHRydWUsIHRydWUpO1xuICAgICAgICAgICAgICAgICAgICB0aGlzLmlubmVyLmRpc3BhdGNoRXZlbnQoZXZlbnQpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH07XG4gICAgICAgICAgICAvKiBtZXRob2QgdG8gcmVnaXN0ZXIgY3VzdG9tIGV2ZW50IGNhbGxiYWNrcyAqL1xuICAgICAgICAgICAgU3dvb3NoLnByb3RvdHlwZS5vbiA9IGZ1bmN0aW9uIChldmVudCwgY2FsbGJhY2spIHtcbiAgICAgICAgICAgICAgICBjb25zb2xlLmxvZygnb24oKSBldmVudCBjYWxsYmFjayByZWdpc3RlcicsIGV2ZW50KTtcbiAgICAgICAgICAgICAgICB0aGlzLmlubmVyLmFkZEV2ZW50TGlzdGVuZXIoZXZlbnQsIGNhbGxiYWNrLmJpbmQodGhpcykpO1xuICAgICAgICAgICAgICAgIHJldHVybiB0aGlzO1xuICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIFN3b29zaC5wcm90b3R5cGUuYWx3YXlzID0gZnVuY3Rpb24gKCkgeyBjb25zb2xlLmxvZygnYWx3YXlzKCknKTsgcmV0dXJuIHRydWU7IH07XG4gICAgICAgICAgICByZXR1cm4gU3dvb3NoO1xuICAgICAgICB9KCkpO1xuICAgICAgICAvKiByZXR1cm4gYW4gaW5zdGFuY2Ugb2YgdGhlIG9iamVjdCAqL1xuICAgICAgICByZXR1cm4gbmV3IFN3b29zaChjb250YWluZXIsIG9wdGlvbnMpO1xuICAgIH1cbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsIHsgdmFsdWU6IHRydWUgfSk7XG4gICAgZXhwb3J0cy5kZWZhdWx0ID0gZGVmYXVsdF8xO1xufSk7XG4vLyMgc291cmNlTWFwcGluZ1VSTD1zd29vc2guanMubWFwIl19
